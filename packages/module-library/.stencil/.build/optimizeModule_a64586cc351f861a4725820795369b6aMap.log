{"version":3,"names":["creditCardFormCss","CreditCardForm","__stencil_proxyCustomElement","HTMLElement","constructor","registerHost","this","disabled","isReady","isValid","errorMessage","adyenCheckout","cardComponent","containerId","Math","random","toString","substr","isInitializing","componentDidLoad","initializeAdyen","disconnectedCallback","unmount","checkAdyenLoaded","window","win","AdyenCheckout","waitForAdyenSDK","Promise","resolve","reject","attempts","maxAttempts","interval","eventListenerAttached","handleSDKLoaded","setTimeout","clearInterval","removeEventListener","handleSDKError","console","log","e","errorDetail","detail","Error","addEventListener","setInterval","error","AdyenCheckoutType","windowKeys","Object","keys","filter","key","toLowerCase","includes","scriptTags","Array","from","document","scripts","map","s","src","createAdyenCheckout","handleError","checkoutConfig","environment","adyenConfig","clientKey","locale","countryCode","onSubmit","state","component","handleSubmit","onError","onChange","handleChange","checkout","checkoutInstance","create","createCardComponent","container","el","querySelector","cardConfig","showPayButton","placeholder","stateData","mount","formReady","emit","data","paymentMethod","formData","cardNumber","encryptedCardNumber","expiryDate","encryptedExpiryDate","cvc","encryptedSecurityCode","holderName","formSubmit","formChange","message","formError","render","h","class","id","role"],"sources":["src/modules/credit-card-form/credit-card-form.css?tag=credit-card-form&encapsulation=scoped","src/modules/credit-card-form/credit-card-form.tsx"],"sourcesContent":["/* Credit Card Form - Scoped CSS */\n\n.credit-card-form {\n\tdisplay: block;\n\twidth: 100%;\n}\n\n.adyen-container {\n\twidth: 100%;\n\tmin-height: 200px;\n}\n\n.adyen-container.disabled {\n\topacity: 0.6;\n\tpointer-events: none;\n}\n\n.error-message {\n\tmargin-top: 12px;\n\tpadding: 12px;\n\tbackground-color: #fee;\n\tborder: 1px solid #fcc;\n\tborder-radius: 4px;\n\tcolor: #c33;\n\tfont-size: 14px;\n}\n\n/* Adyen 樣式覆蓋（如果需要自定義） */\n.credit-card-form :global(.adyen-checkout__input) {\n\tfont-family: inherit;\n}\n\n.credit-card-form :global(.adyen-checkout__input--error) {\n\tborder-color: #c33;\n}\n\n","import { Component, Prop, Event, State, h, Element } from \"@stencil/core\";\nimport type { EventEmitter } from \"@stencil/core\";\n\nexport interface AdyenConfig {\n\tenvironment: \"test\" | \"live\";\n\tclientKey: string;\n\tlocale?: string;\n\tcountryCode: string; // 必需：ISO 3166-1 alpha-2 國家代碼（例如：US, GB, TW）\n\tshowPayButton?: boolean;\n\tonSubmit?: (state: unknown, component: unknown) => void;\n\tonError?: (error: unknown, component: unknown) => void;\n\tonChange?: (state: unknown, component: unknown) => void;\n}\n\nexport interface CreditCardFormData {\n\tcardNumber: string;\n\texpiryDate: string;\n\tcvc: string;\n\tholderName?: string;\n}\n\n@Component({\n\ttag: \"credit-card-form\",\n\tstyleUrl: \"credit-card-form.css\",\n\tshadow: false,\n\tscoped: true,\n})\nexport class CreditCardForm {\n\t@Element() el!: HTMLElement;\n\n\t@Prop() adyenConfig!: AdyenConfig;\n\t@Prop() placeholder?: {\n\t\tcardNumber?: string;\n\t\texpiryDate?: string;\n\t\tcvc?: string;\n\t\tholderName?: string;\n\t};\n\t@Prop() disabled = false;\n\n\t@State() isReady = false;\n\t@State() isValid = false;\n\t@State() errorMessage = \"\";\n\n\t@Event() formReady!: EventEmitter<void>;\n\t@Event() formChange!: EventEmitter<CreditCardFormData>;\n\t@Event() formSubmit!: EventEmitter<CreditCardFormData>;\n\t@Event() formError!: EventEmitter<{ message: string; error: unknown }>;\n\n\tprivate adyenCheckout: {\n\t\tcreate: (\n\t\t\ttype: string,\n\t\t\tconfig: unknown,\n\t\t) => { mount: (selector: string) => void; unmount?: () => void };\n\t} | null = null;\n\tprivate cardComponent: {\n\t\tunmount?: () => void;\n\t\tmount?: (selector: string) => void;\n\t} | null = null;\n\tprivate containerId = `adyen-card-container-${Math.random()\n\t\t.toString(36)\n\t\t.substr(2, 9)}`;\n\tprivate isInitializing = false;\n\n\tasync componentDidLoad() {\n\t\tawait this.initializeAdyen();\n\t}\n\n\tasync disconnectedCallback() {\n\t\tif (this.cardComponent?.unmount) {\n\t\t\tthis.cardComponent.unmount();\n\t\t}\n\t}\n\n\t/**\n\t * 檢查 Adyen SDK 是否已載入\n\t * Adyen 6.0.0 使用 window.AdyenCheckout 作為全局對象\n\t */\n\tprivate checkAdyenLoaded(): boolean {\n\t\tif (typeof window === \"undefined\") {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst win = window as {\n\t\t\tAdyenCheckout?: unknown;\n\t\t};\n\n\t\t// Adyen 6.0.0 使用 AdyenCheckout 作為全局對象\n\t\tif (!win.AdyenCheckout) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// 檢查 AdyenCheckout 是否為函數（可調用）\n\t\tconst AdyenCheckout = win.AdyenCheckout as\n\t\t\t| ((config: unknown) => Promise<unknown>)\n\t\t\t| undefined;\n\n\t\treturn typeof AdyenCheckout === \"function\";\n\t}\n\n\t/**\n\t * 等待 Adyen SDK 載入完成\n\t */\n\tprivate waitForAdyenSDK(): Promise<void> {\n\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\t// 如果已經載入，直接 resolve\n\t\t\tif (this.checkAdyenLoaded()) {\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet attempts = 0;\n\t\t\tconst maxAttempts = 100; // 100 * 100ms = 10 秒\n\t\t\tlet interval: NodeJS.Timeout | null = null;\n\t\t\tlet eventListenerAttached = false;\n\n\t\t\t// 監聽 SDK 載入事件（從 _app.tsx 觸發）\n\t\t\tconst handleSDKLoaded = () => {\n\t\t\t\t// 再次檢查確保 SDK 真的可用\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (this.checkAdyenLoaded()) {\n\t\t\t\t\t\tif (interval !== null) {\n\t\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (eventListenerAttached) {\n\t\t\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-loaded\", handleSDKLoaded);\n\t\t\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-error\", handleSDKError);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log(\"Adyen SDK loaded and ready\");\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t};\n\n\t\t\tconst handleSDKError = (e: Event) => {\n\t\t\t\tif (interval !== null) {\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t}\n\t\t\t\tif (eventListenerAttached) {\n\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-loaded\", handleSDKLoaded);\n\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-error\", handleSDKError);\n\t\t\t\t}\n\t\t\t\tconst errorDetail = (e as CustomEvent).detail;\n\t\t\t\treject(\n\t\t\t\t\tnew Error(\n\t\t\t\t\t\t`Adyen SDK failed to load: ${errorDetail || \"Unknown error\"}`,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// 監聽自定義事件\n\t\t\twindow.addEventListener(\"adyen-sdk-loaded\", handleSDKLoaded);\n\t\t\twindow.addEventListener(\"adyen-sdk-error\", handleSDKError);\n\t\t\teventListenerAttached = true;\n\n\t\t\t// 輪詢檢查作為備用方案\n\t\t\tinterval = setInterval(() => {\n\t\t\t\tattempts++;\n\t\t\t\tif (this.checkAdyenLoaded()) {\n\t\t\t\t\tif (interval !== null) {\n\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t}\n\t\t\t\t\tif (eventListenerAttached) {\n\t\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-loaded\", handleSDKLoaded);\n\t\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-error\", handleSDKError);\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(\"Adyen SDK detected via polling\");\n\t\t\t\t\tresolve();\n\t\t\t\t} else if (attempts >= maxAttempts) {\n\t\t\t\t\tif (interval !== null) {\n\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t}\n\t\t\t\t\tif (eventListenerAttached) {\n\t\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-loaded\", handleSDKLoaded);\n\t\t\t\t\t\twindow.removeEventListener(\"adyen-sdk-error\", handleSDKError);\n\t\t\t\t\t}\n\n\t\t\t\t\t// 調試信息\n\t\t\t\t\tconst win = window as { AdyenCheckout?: unknown };\n\t\t\t\t\tconsole.error(\"Adyen SDK timeout. Debug info:\", {\n\t\t\t\t\t\tAdyenCheckout: !!win.AdyenCheckout,\n\t\t\t\t\t\tAdyenCheckoutType: typeof win.AdyenCheckout,\n\t\t\t\t\t\twindowKeys: Object.keys(window).filter((key) =>\n\t\t\t\t\t\t\tkey.toLowerCase().includes(\"adyen\"),\n\t\t\t\t\t\t),\n\t\t\t\t\t\tscriptTags: Array.from(document.scripts).map((s) => s.src),\n\t\t\t\t\t});\n\n\t\t\t\t\treject(\n\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\"Adyen SDK failed to load: timeout after 10 seconds. Please ensure the Adyen SDK is loaded via CDN.\",\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t});\n\t}\n\n\t/**\n\t * 初始化 Adyen\n\t */\n\tprivate async initializeAdyen() {\n\t\t// 防止重複初始化\n\t\tif (this.isInitializing) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\t// 檢查是否在瀏覽器環境\n\t\t\tif (typeof window === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isInitializing = true;\n\n\t\t\t// 等待 Adyen SDK 載入\n\t\t\tawait this.waitForAdyenSDK();\n\n\t\t\t// 創建 Adyen Checkout 實例\n\t\t\tawait this.createAdyenCheckout();\n\t\t} catch (error) {\n\t\t\tthis.handleError(\"Failed to initialize Adyen\", error);\n\t\t} finally {\n\t\t\tthis.isInitializing = false;\n\t\t}\n\t}\n\n\t/**\n\t * 創建 Adyen Checkout 實例並初始化 Card 組件\n\t */\n\tprivate async createAdyenCheckout() {\n\t\ttry {\n\t\t\tconst win = window as {\n\t\t\t\tAdyenCheckout?: (config: unknown) => Promise<unknown>;\n\t\t\t};\n\n\t\t\tconst AdyenCheckout = win.AdyenCheckout;\n\n\t\t\tif (!AdyenCheckout || typeof AdyenCheckout !== \"function\") {\n\t\t\t\tthrow new Error(\"AdyenCheckout is not available or not a function\");\n\t\t\t}\n\n\t\t\t// 構建 Adyen Checkout 配置\n\t\t\t// 根據 Adyen 6.0.0 文檔，配置結構如下\n\t\t\tconst checkoutConfig = {\n\t\t\t\tenvironment: this.adyenConfig.environment,\n\t\t\t\tclientKey: this.adyenConfig.clientKey,\n\t\t\t\tlocale: this.adyenConfig.locale || \"en-US\",\n\t\t\t\tcountryCode: this.adyenConfig.countryCode,\n\t\t\t\tonSubmit: (state: unknown, component: unknown) => {\n\t\t\t\t\t// 調用用戶提供的 onSubmit（如果存在）\n\t\t\t\t\tif (this.adyenConfig.onSubmit) {\n\t\t\t\t\t\tthis.adyenConfig.onSubmit(state, component);\n\t\t\t\t\t}\n\t\t\t\t\t// 處理表單提交\n\t\t\t\t\tthis.handleSubmit(state);\n\t\t\t\t},\n\t\t\t\tonError: (error: unknown, component: unknown) => {\n\t\t\t\t\t// 調用用戶提供的 onError（如果存在）\n\t\t\t\t\tif (this.adyenConfig.onError) {\n\t\t\t\t\t\tthis.adyenConfig.onError(error, component);\n\t\t\t\t\t}\n\t\t\t\t\t// 處理錯誤\n\t\t\t\t\tthis.handleError(\"Payment error\", error);\n\t\t\t\t},\n\t\t\t\tonChange: (state: unknown, component: unknown) => {\n\t\t\t\t\t// 調用用戶提供的 onChange（如果存在）\n\t\t\t\t\tif (this.adyenConfig.onChange) {\n\t\t\t\t\t\tthis.adyenConfig.onChange(state, component);\n\t\t\t\t\t}\n\t\t\t\t\t// 處理表單變更\n\t\t\t\t\tthis.handleChange(state);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t// 創建 Adyen Checkout 實例\n\t\t\tconst checkout = await AdyenCheckout(checkoutConfig);\n\n\t\t\tif (!checkout || typeof checkout !== \"object\") {\n\t\t\t\tthrow new Error(\"Failed to create Adyen Checkout instance\");\n\t\t\t}\n\n\t\t\t// 檢查 checkout 是否有 create 方法\n\t\t\tconst checkoutInstance = checkout as {\n\t\t\t\tcreate?: (\n\t\t\t\t\ttype: string,\n\t\t\t\t\tconfig: unknown,\n\t\t\t\t) => { mount: (selector: string) => void; unmount?: () => void };\n\t\t\t};\n\n\t\t\tif (\n\t\t\t\t!checkoutInstance.create ||\n\t\t\t\ttypeof checkoutInstance.create !== \"function\"\n\t\t\t) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t\"Adyen Checkout instance does not have a create method\",\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.adyenCheckout = checkoutInstance as {\n\t\t\t\tcreate: (\n\t\t\t\t\ttype: string,\n\t\t\t\t\tconfig: unknown,\n\t\t\t\t) => { mount: (selector: string) => void; unmount?: () => void };\n\t\t\t};\n\n\t\t\t// 創建 Card 組件\n\t\t\tawait this.createCardComponent();\n\t\t} catch (error) {\n\t\t\tthis.handleError(\"Failed to create Adyen checkout\", error);\n\t\t}\n\t}\n\n\t/**\n\t * 創建並掛載 Card 組件\n\t */\n\tprivate async createCardComponent() {\n\t\tif (!this.adyenCheckout) {\n\t\t\tthrow new Error(\"Adyen Checkout instance is not available\");\n\t\t}\n\n\t\tconst container = this.el.querySelector(`#${this.containerId}`);\n\t\tif (!container) {\n\t\t\tthrow new Error(`Container element #${this.containerId} not found`);\n\t\t}\n\n\t\ttry {\n\t\t\t// 創建 Card 組件配置\n\t\t\tconst cardConfig = {\n\t\t\t\tshowPayButton: this.adyenConfig.showPayButton ?? false,\n\t\t\t\tplaceholder: this.placeholder || {},\n\t\t\t\tonChange: (state: unknown) => {\n\t\t\t\t\tconst stateData = state as { isValid: boolean };\n\t\t\t\t\tthis.isValid = stateData.isValid;\n\t\t\t\t\tif (stateData.isValid) {\n\t\t\t\t\t\tthis.errorMessage = \"\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t// 創建 Card 組件\n\t\t\tthis.cardComponent = this.adyenCheckout.create(\"card\", cardConfig);\n\n\t\t\tif (!this.cardComponent || !this.cardComponent.mount) {\n\t\t\t\tthrow new Error(\"Failed to create Card component\");\n\t\t\t}\n\n\t\t\t// 掛載組件到容器\n\t\t\tthis.cardComponent.mount(`#${this.containerId}`);\n\n\t\t\t// 標記為準備就緒\n\t\t\tthis.isReady = true;\n\t\t\tthis.formReady.emit();\n\t\t} catch (error) {\n\t\t\tthis.handleError(\"Failed to create Card component\", error);\n\t\t}\n\t}\n\n\t/**\n\t * 處理表單提交\n\t */\n\tprivate handleSubmit(state: unknown) {\n\t\tconst stateData = state as {\n\t\t\tisValid: boolean;\n\t\t\tdata?: { paymentMethod?: Record<string, unknown> };\n\t\t};\n\n\t\tif (stateData.isValid && stateData.data?.paymentMethod) {\n\t\t\tconst paymentMethod = stateData.data.paymentMethod as Record<\n\t\t\t\tstring,\n\t\t\t\tstring\n\t\t\t>;\n\n\t\t\tconst formData: CreditCardFormData = {\n\t\t\t\tcardNumber: paymentMethod.encryptedCardNumber || \"\",\n\t\t\t\texpiryDate: paymentMethod.encryptedExpiryDate || \"\",\n\t\t\t\tcvc: paymentMethod.encryptedSecurityCode || \"\",\n\t\t\t\tholderName: paymentMethod.holderName || \"\",\n\t\t\t};\n\n\t\t\tthis.formSubmit.emit(formData);\n\t\t}\n\t}\n\n\t/**\n\t * 處理表單變更\n\t */\n\tprivate handleChange(state: unknown) {\n\t\tconst stateData = state as {\n\t\t\tisValid: boolean;\n\t\t\tdata?: { paymentMethod?: Record<string, unknown> };\n\t\t};\n\n\t\tif (stateData.isValid && stateData.data?.paymentMethod) {\n\t\t\tconst paymentMethod = stateData.data.paymentMethod as Record<\n\t\t\t\tstring,\n\t\t\t\tstring\n\t\t\t>;\n\n\t\t\tconst formData: CreditCardFormData = {\n\t\t\t\tcardNumber: paymentMethod.encryptedCardNumber || \"\",\n\t\t\t\texpiryDate: paymentMethod.encryptedExpiryDate || \"\",\n\t\t\t\tcvc: paymentMethod.encryptedSecurityCode || \"\",\n\t\t\t\tholderName: paymentMethod.holderName || \"\",\n\t\t\t};\n\n\t\t\tthis.formChange.emit(formData);\n\t\t}\n\t}\n\n\t/**\n\t * 處理錯誤\n\t */\n\tprivate handleError(message: string, error: unknown) {\n\t\tthis.errorMessage = message;\n\t\tthis.formError.emit({ message, error });\n\t\tconsole.error(`[CreditCardForm] ${message}:`, error);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div class=\"credit-card-form\">\n\t\t\t\t<div\n\t\t\t\t\tid={this.containerId}\n\t\t\t\t\tclass={`adyen-container ${this.disabled ? \"disabled\" : \"\"}`}\n\t\t\t\t/>\n\t\t\t\t{this.errorMessage && (\n\t\t\t\t\t<div class=\"error-message\" role=\"alert\">\n\t\t\t\t\t\t{this.errorMessage}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}
import{proxyCustomElement as e,HTMLElement as t,createEvent as i,h as r,transformTag as n}from"@stencil/core/internal/client";export{getAssetPath,render,setAssetPath,setNonce,setPlatformOptions}from"@stencil/core/internal/client";const o=()=>`.credit-card-form.sc-credit-card-form{display:block;width:100%}.adyen-container.sc-credit-card-form{width:100%;min-height:200px;padding:16px 0}.adyen-container.disabled.sc-credit-card-form{opacity:0.6;pointer-events:none}.error-message.sc-credit-card-form{margin-top:12px;padding:12px;background-color:#fee;border:1px solid #fcc;border-radius:4px;color:#c33;font-size:14px}`;let s=null;let a=null;async function c(){if(typeof window==="undefined"){return false}try{const e=await import("./index2.js");s=e.AdyenCheckout;a=e.Card;return true}catch(e){console.error("Failed to load Adyen SDK:",e);return false}}const d=e(class e extends t{constructor(e){super();if(e!==false){this.__registerHost()}this.formReady=i(this,"formReady",7);this.formChange=i(this,"formChange",7);this.formSubmit=i(this,"formSubmit",7);this.formError=i(this,"formError",7);this.disabled=false;this.isReady=false;this.isValid=false;this.errorMessage="";this.adyenCheckout=null;this.cardComponent=null;this.containerId=`adyen-card-container-${Math.random().toString(36).substr(2,9)}`;this.isInitializing=false}async componentDidLoad(){await this.initializeAdyen()}async disconnectedCallback(){if(this.cardComponent?.unmount){this.cardComponent.unmount()}}checkAdyenLoaded(){return s!==null&&typeof s==="function"&&a!==null&&typeof a==="function"}async loadAdyenSDK(){if(this.checkAdyenLoaded()){return}const e=await c();if(!e){throw new Error("Failed to load Adyen SDK. Please ensure @adyen/adyen-web is installed.")}if(!this.checkAdyenLoaded()){throw new Error("Adyen SDK loaded but AdyenCheckout or Card is not available.")}}async initializeAdyen(){if(this.isInitializing){return}try{if(typeof window==="undefined"){return}this.isInitializing=true;await this.loadAdyenSDK();await this.createAdyenCheckout()}catch(e){this.handleError("Failed to initialize Adyen",e)}finally{this.isInitializing=false}}async createAdyenCheckout(){try{if(!s||typeof s!=="function"){throw new Error("AdyenCheckout is not available or not a function")}const e={...this.adyenConfig,countryCode:this.adyenConfig.countryCode||"US",onSubmit:async(e,t,i)=>{try{if(this.adyenConfig.onSubmit){await this.adyenConfig.onSubmit(e,t,i)}const r=this.extractFormData(e);if(r){this.formSubmit.emit(r)}if(i){i.resolve(undefined)}}catch(e){if(i){i.reject()}this.handleError("Payment submission error",e)}},onError:(e,t)=>{if(this.adyenConfig.onError){this.adyenConfig.onError(e,t)}this.handleError("Payment error",e)},onChange:(e,t)=>{if(this.adyenConfig.onChange){this.adyenConfig.onChange(e,t)}this.handleChange(e)}};console.log("[CreditCardForm] Checkout config:",JSON.stringify(e,null,2));const t=await s(e);if(!t||typeof t!=="object"){throw new Error("Failed to create Adyen Checkout instance")}console.log("[CreditCardForm] Checkout instance created:",t);this.adyenCheckout=t;await this.createCardComponent()}catch(e){this.handleError("Failed to create Adyen checkout",e)}}async createCardComponent(){if(!this.adyenCheckout){throw new Error("Adyen Checkout instance is not available")}const e=this.el.querySelector(`#${this.containerId}`);if(!e){throw new Error(`Container element #${this.containerId} not found`)}if(!a||typeof a!=="function"){throw new Error("Card constructor is not available. Please ensure @adyen/adyen-web is installed.")}try{const e=this.placeholder||{};const t={showPayButton:this.adyenConfig.showPayButton??false,hasHolderName:true,placeholders:e,...this.cardStyles?{styles:this.cardStyles}:{},onChange:e=>{const t=e;this.isValid=t.isValid;if(t.isValid){this.errorMessage=""}this.handleChange(e)}};if(Object.keys(e).length>0){console.log("[CreditCardForm] Placeholder configured:",e)}if(this.cardStyles){console.log("[CreditCardForm] Card styles in Card config:",this.cardStyles)}console.log("[CreditCardForm] Card config:",JSON.stringify(t,null,2));this.cardComponent=new a(this.adyenCheckout,t);console.log("[CreditCardForm] Card component created:",this.cardComponent);if(!this.cardComponent){throw new Error("Failed to create Card component: component is null")}if(!this.cardComponent.mount||typeof this.cardComponent.mount!=="function"){throw new Error("Failed to create Card component: mount method is not available")}await new Promise((e=>setTimeout(e,0)));this.cardComponent.mount(`#${this.containerId}`);this.isReady=true;this.formReady.emit()}catch(e){this.handleError("Failed to create Card component",e);throw e}}extractFormData(e){const t=e;if(t.isValid&&t.data?.paymentMethod){const e=t.data.paymentMethod;return{cardNumber:e.encryptedCardNumber||"",expiryDate:e.encryptedExpiryDate||"",cvc:e.encryptedSecurityCode||"",holderName:e.holderName||""}}return null}handleChange(e){const t=e;if(t.isValid&&t.data?.paymentMethod){const e=t.data.paymentMethod;const i={cardNumber:e.encryptedCardNumber||"",expiryDate:e.encryptedExpiryDate||"",cvc:e.encryptedSecurityCode||"",holderName:e.holderName||""};this.formChange.emit(i)}}handleError(e,t){this.errorMessage=e;this.formError.emit({message:e,error:t});console.error(`[CreditCardForm] ${e}:`,t)}render(){return r("div",{key:"6c20b1e31f210c778459eb97979dd9ab06468691",class:"credit-card-form"},r("div",{key:"af3ea0807adeecbabb252f369e3911952ccfc09f",id:this.containerId,class:`adyen-container ${this.disabled?"disabled":""}`}),this.errorMessage&&r("div",{key:"119c342b864f0db480c0e51a063e6d7888f07e67",class:"error-message",role:"alert"},this.errorMessage))}get el(){return this}static get style(){return o()}},[2,"credit-card-form",{adyenConfig:[16],placeholder:[16],cardStyles:[16],disabled:[4],isReady:[32],isValid:[32],errorMessage:[32]}]);function h(){if(typeof customElements==="undefined"){return}const e=["credit-card-form"];e.forEach((e=>{switch(e){case"credit-card-form":if(!customElements.get(n(e))){customElements.define(n(e),d)}break}}))}h();export{d as CreditCardForm,h as defineCustomElement};
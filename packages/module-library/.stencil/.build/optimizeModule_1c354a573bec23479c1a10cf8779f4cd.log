import{r,c as e,h as c,g as t}from"./p-B89yKvQN.js";const o=()=>`.credit-card-form.sc-credit-card-form{display:block;width:100%}.adyen-container.sc-credit-card-form{width:100%;min-height:200px;padding:16px 0}.adyen-container.disabled.sc-credit-card-form{opacity:0.6;pointer-events:none}.error-message.sc-credit-card-form{margin-top:12px;padding:12px;background-color:#fee;border:1px solid #fcc;border-radius:4px;color:#c33;font-size:14px}.credit-card-form.sc-credit-card-form .adyen-checkout__input.sc-credit-card-form{font-family:inherit;font-size:16px;padding:12px 16px;border:1px solid #d0d0d0;border-radius:6px;transition:border-color 0.2s ease, box-shadow 0.2s ease;background-color:#fff;color:#333}.credit-card-form.sc-credit-card-form .adyen-checkout__input.sc-credit-card-form:focus{outline:none;border-color:#0066cc;box-shadow:0 0 0 3px rgba(0, 102, 204, 0.1)}.credit-card-form.sc-credit-card-form .adyen-checkout__input--error.sc-credit-card-form{border-color:#c33;background-color:#fff5f5}.credit-card-form.sc-credit-card-form .adyen-checkout__input--error.sc-credit-card-form:focus{border-color:#c33;box-shadow:0 0 0 3px rgba(204, 51, 51, 0.1)}.credit-card-form.sc-credit-card-form .adyen-checkout__input--valid.sc-credit-card-form{border-color:#28a745}.credit-card-form.sc-credit-card-form .adyen-checkout__label.sc-credit-card-form{font-size:14px;font-weight:500;color:#333;margin-bottom:8px;display:block}.credit-card-form.sc-credit-card-form .adyen-checkout__error-text.sc-credit-card-form{color:#c33;font-size:13px;margin-top:6px;display:block}.credit-card-form.sc-credit-card-form .adyen-checkout__field.sc-credit-card-form{margin-bottom:20px}.credit-card-form.sc-credit-card-form .adyen-checkout__field-wrapper.sc-credit-card-form{position:relative}.credit-card-form.sc-credit-card-form .adyen-checkout__field--cardNumber.sc-credit-card-form{margin-bottom:20px}.credit-card-form.sc-credit-card-form .adyen-checkout__field--expiryDate.sc-credit-card-form,.credit-card-form.sc-credit-card-form .adyen-checkout__field--securityCode.sc-credit-card-form{margin-bottom:20px}.credit-card-form.sc-credit-card-form .adyen-checkout__field--holderName.sc-credit-card-form{margin-bottom:20px}.credit-card-form.sc-credit-card-form .adyen-checkout__button.sc-credit-card-form{width:100%;padding:14px 24px;font-size:16px;font-weight:600;border-radius:6px;transition:background-color 0.2s ease, transform 0.1s ease;cursor:pointer}.credit-card-form.sc-credit-card-form .adyen-checkout__button.sc-credit-card-form:hover{transform:translateY(-1px)}.credit-card-form.sc-credit-card-form .adyen-checkout__button.sc-credit-card-form:active{transform:translateY(0)}.credit-card-form.sc-credit-card-form .adyen-checkout__button.sc-credit-card-form:disabled{opacity:0.6;cursor:not-allowed;transform:none}.credit-card-form.sc-credit-card-form .adyen-checkout__spinner.sc-credit-card-form{border-color:#0066cc}@media (max-width: 768px){.credit-card-form.sc-credit-card-form .adyen-checkout__input.sc-credit-card-form{font-size:16px;padding:14px 16px}.adyen-container.sc-credit-card-form{padding:12px 0}}@media (prefers-color-scheme: dark){.credit-card-form.sc-credit-card-form .adyen-checkout__input.sc-credit-card-form{background-color:#2a2a2a;border-color:#444;color:#fff}.credit-card-form.sc-credit-card-form .adyen-checkout__input.sc-credit-card-form:focus{border-color:#0066cc;background-color:#2a2a2a}.credit-card-form.sc-credit-card-form .adyen-checkout__label.sc-credit-card-form{color:#e0e0e0}}`;let i=null;let a=null;async function d(){if(typeof window==="undefined"){return false}try{const r=await import("./p-BPrHjqtQ.js");i=r.AdyenCheckout;a=r.Card;return true}catch(r){console.error("Failed to load Adyen SDK:",r);return false}}const n=class{constructor(c){r(this,c);this.formReady=e(this,"formReady");this.formChange=e(this,"formChange");this.formSubmit=e(this,"formSubmit");this.formError=e(this,"formError");this.disabled=false;this.isReady=false;this.isValid=false;this.errorMessage="";this.adyenCheckout=null;this.cardComponent=null;this.containerId=`adyen-card-container-${Math.random().toString(36).substr(2,9)}`;this.isInitializing=false}async componentDidLoad(){await this.initializeAdyen()}async disconnectedCallback(){if(this.cardComponent?.unmount){this.cardComponent.unmount()}}checkAdyenLoaded(){return i!==null&&typeof i==="function"&&a!==null&&typeof a==="function"}async loadAdyenSDK(){if(this.checkAdyenLoaded()){return}const r=await d();if(!r){throw new Error("Failed to load Adyen SDK. Please ensure @adyen/adyen-web is installed.")}if(!this.checkAdyenLoaded()){throw new Error("Adyen SDK loaded but AdyenCheckout or Card is not available.")}}async initializeAdyen(){if(this.isInitializing){return}try{if(typeof window==="undefined"){return}this.isInitializing=true;await this.loadAdyenSDK();await this.createAdyenCheckout()}catch(r){this.handleError("Failed to initialize Adyen",r)}finally{this.isInitializing=false}}async createAdyenCheckout(){try{if(!i||typeof i!=="function"){throw new Error("AdyenCheckout is not available or not a function")}const r={environment:this.adyenConfig.environment,clientKey:this.adyenConfig.clientKey,locale:this.adyenConfig.locale||"en-US",countryCode:this.adyenConfig.countryCode,onSubmit:async(r,e,c)=>{try{if(this.adyenConfig.onSubmit){await this.adyenConfig.onSubmit(r,e,c)}const t=this.extractFormData(r);if(t){this.formSubmit.emit(t)}if(c){c.resolve()}}catch(r){if(c){c.reject()}this.handleError("Payment submission error",r)}},onError:(r,e)=>{if(this.adyenConfig.onError){this.adyenConfig.onError(r,e)}this.handleError("Payment error",r)},onChange:(r,e)=>{if(this.adyenConfig.onChange){this.adyenConfig.onChange(r,e)}this.handleChange(r)}};const e=await i(r);if(!e||typeof e!=="object"){throw new Error("Failed to create Adyen Checkout instance")}this.adyenCheckout=e;await this.createCardComponent()}catch(r){this.handleError("Failed to create Adyen checkout",r)}}async createCardComponent(){if(!this.adyenCheckout){throw new Error("Adyen Checkout instance is not available")}const r=this.el.querySelector(`#${this.containerId}`);if(!r){throw new Error(`Container element #${this.containerId} not found`)}if(!a||typeof a!=="function"){throw new Error("Card constructor is not available. Please ensure @adyen/adyen-web is installed.")}try{const r={showPayButton:this.adyenConfig.showPayButton??false,placeholder:this.placeholder||{},onChange:r=>{const e=r;this.isValid=e.isValid;if(e.isValid){this.errorMessage=""}this.handleChange(r)}};this.cardComponent=new a(this.adyenCheckout,r);if(!this.cardComponent){throw new Error("Failed to create Card component: component is null")}if(!this.cardComponent.mount||typeof this.cardComponent.mount!=="function"){throw new Error("Failed to create Card component: mount method is not available")}await new Promise((r=>setTimeout(r,0)));this.cardComponent.mount(`#${this.containerId}`);this.isReady=true;this.formReady.emit()}catch(r){this.handleError("Failed to create Card component",r);throw r}}extractFormData(r){const e=r;if(e.isValid&&e.data?.paymentMethod){const r=e.data.paymentMethod;return{cardNumber:r.encryptedCardNumber||"",expiryDate:r.encryptedExpiryDate||"",cvc:r.encryptedSecurityCode||"",holderName:r.holderName||""}}return null}handleChange(r){const e=r;if(e.isValid&&e.data?.paymentMethod){const r=e.data.paymentMethod;const c={cardNumber:r.encryptedCardNumber||"",expiryDate:r.encryptedExpiryDate||"",cvc:r.encryptedSecurityCode||"",holderName:r.holderName||""};this.formChange.emit(c)}}handleError(r,e){this.errorMessage=r;this.formError.emit({message:r,error:e});console.error(`[CreditCardForm] ${r}:`,e)}render(){return c("div",{key:"cea577c307bc242e06eb52508098626f2d746af3",class:"credit-card-form"},c("div",{key:"c3a6a6248874d9b42446b31398a047e24ba4a7eb",id:this.containerId,class:`adyen-container ${this.disabled?"disabled":""}`}),this.errorMessage&&c("div",{key:"bb0ca17dfb484a12e10914834e236bc69a5c4b96",class:"error-message",role:"alert"},this.errorMessage))}get el(){return t(this)}};n.style=o();export{n as CreditCardForm};
{"version":3,"names":["creditCardFormCss","AdyenCheckout","Card","async","loadAdyenSDK","window","adyenModule","import","error","console","CreditCardForm","constructor","hostRef","this","disabled","isReady","isValid","errorMessage","adyenCheckout","cardComponent","containerId","Math","random","toString","substr","isInitializing","componentDidLoad","initializeAdyen","disconnectedCallback","unmount","checkAdyenLoaded","loaded","Error","createAdyenCheckout","handleError","checkoutConfig","environment","adyenConfig","clientKey","locale","countryCode","onSubmit","state","component","actions","formData","extractFormData","formSubmit","emit","resolve","reject","onError","onChange","handleChange","cardStyles","paymentMethodsConfiguration","pmConfig","card","styles","log","JSON","stringify","checkout","createCardComponent","container","el","querySelector","placeholderConfig","placeholder","cardConfig","showPayButton","stateData","Object","keys","length","mount","Promise","setTimeout","formReady","data","paymentMethod","cardNumber","encryptedCardNumber","expiryDate","encryptedExpiryDate","cvc","encryptedSecurityCode","holderName","formChange","message","formError","render","h","key","class","id","role"],"sources":["src/modules/credit-card-form/credit-card-form.css?tag=credit-card-form&encapsulation=scoped","src/modules/credit-card-form/credit-card-form.tsx"],"sourcesContent":["/* Credit Card Form - Scoped CSS */\n\n.credit-card-form {\n\tdisplay: block;\n\twidth: 100%;\n}\n\n.adyen-container {\n\twidth: 100%;\n\tmin-height: 200px;\n\tpadding: 16px 0;\n}\n\n.adyen-container.disabled {\n\topacity: 0.6;\n\tpointer-events: none;\n}\n\n.error-message {\n\tmargin-top: 12px;\n\tpadding: 12px;\n\tbackground-color: #fee;\n\tborder: 1px solid #fcc;\n\tborder-radius: 4px;\n\tcolor: #c33;\n\tfont-size: 14px;\n}","import { Component, Prop, Event, State, h, Element } from \"@stencil/core\";\nimport type { EventEmitter } from \"@stencil/core\";\n// 動態導入 Adyen Web SDK（僅在瀏覽器環境中）\nlet AdyenCheckout: ((config: unknown) => Promise<unknown>) | null = null;\nlet Card:\n\t| (new (\n\t\t\tcheckout: unknown,\n\t\t\tconfig: unknown,\n\t  ) => { mount: (selector: string) => void; unmount?: () => void })\n\t| null = null;\n\n// 動態載入 Adyen SDK\nasync function loadAdyenSDK() {\n\tif (typeof window === \"undefined\") {\n\t\treturn false;\n\t}\n\n\ttry {\n\t\t// 動態導入 @adyen/adyen-web\n\t\tconst adyenModule = await import(\"@adyen/adyen-web\");\n\t\tAdyenCheckout = adyenModule.AdyenCheckout as (\n\t\t\tconfig: unknown,\n\t\t) => Promise<unknown>;\n\t\tCard = adyenModule.Card as new (\n\t\t\tcheckout: unknown,\n\t\t\tconfig: unknown,\n\t\t) => { mount: (selector: string) => void; unmount?: () => void };\n\t\treturn true;\n\t} catch (error) {\n\t\tconsole.error(\"Failed to load Adyen SDK:\", error);\n\t\treturn false;\n\t}\n}\n\nexport interface AdyenCardStyles {\n\tbase?: {\n\t\tcolor?: string;\n\t\tfontSize?: string;\n\t\tfontWeight?: string;\n\t\tfontSmoothing?: string;\n\t\tfontFamily?: string;\n\t\t\"::placeholder\"?: {\n\t\t\tcolor?: string;\n\t\t\tfontWeight?: string;\n\t\t};\n\t\t\":-webkit-autofill\"?: {\n\t\t\tcolor?: string;\n\t\t};\n\t};\n\terror?: {\n\t\tcolor?: string;\n\t};\n\tplaceholder?: {\n\t\tcolor?: string;\n\t\tfontWeight?: string;\n\t};\n\tvalidated?: {\n\t\tcolor?: string;\n\t};\n}\n\nexport interface AdyenConfig {\n\tenvironment: \"test\" | \"live\";\n\tclientKey: string;\n\tlocale?: string;\n\tcountryCode: string; // 必需：ISO 3166-1 alpha-2 國家代碼（例如：US, GB, TW）\n\tshowPayButton?: boolean;\n\t// Adyen Card 樣式配置（用於 iframe 內的輸入字段）\n\tcardStyles?: AdyenCardStyles;\n\t// Adyen v6: onSubmit 現在包含 actions 參數\n\tonSubmit?: (\n\t\tstate: unknown,\n\t\tcomponent: unknown,\n\t\tactions?: { resolve: (data?: unknown) => void; reject: () => void },\n\t) => void;\n\tonError?: (error: unknown, component: unknown) => void;\n\tonChange?: (state: unknown, component: unknown) => void;\n}\n\nexport interface CreditCardFormData {\n\tcardNumber: string;\n\texpiryDate: string;\n\tcvc: string;\n\tholderName?: string;\n}\n\n@Component({\n\ttag: \"credit-card-form\",\n\tstyleUrl: \"credit-card-form.css\",\n\tshadow: false,\n\tscoped: true,\n})\nexport class CreditCardForm {\n\t@Element() el!: HTMLElement;\n\n\t@Prop() adyenConfig!: AdyenConfig;\n\t@Prop() placeholder?: {\n\t\tcardNumber?: string;\n\t\texpiryDate?: string;\n\t\tcvc?: string;\n\t\tholderName?: string;\n\t};\n\t@Prop() disabled = false;\n\n\t@State() isReady = false;\n\t@State() isValid = false;\n\t@State() errorMessage = \"\";\n\n\t@Event() formReady!: EventEmitter<void>;\n\t@Event() formChange!: EventEmitter<CreditCardFormData>;\n\t@Event() formSubmit!: EventEmitter<CreditCardFormData>;\n\t@Event() formError!: EventEmitter<{ message: string; error: unknown }>;\n\n\t// Adyen v6: checkout 實例\n\tprivate adyenCheckout: unknown = null;\n\t// Adyen v6: Card 組件實例（使用構造函數創建）\n\tprivate cardComponent: {\n\t\tunmount?: () => void;\n\t\tmount: (selector: string) => void;\n\t} | null = null;\n\tprivate containerId = `adyen-card-container-${Math.random()\n\t\t.toString(36)\n\t\t.substr(2, 9)}`;\n\tprivate isInitializing = false;\n\n\tasync componentDidLoad() {\n\t\tawait this.initializeAdyen();\n\t}\n\n\tasync disconnectedCallback() {\n\t\tif (this.cardComponent?.unmount) {\n\t\t\tthis.cardComponent.unmount();\n\t\t}\n\t}\n\n\t/**\n\t * 檢查 Adyen SDK 是否已載入\n\t * 使用 npm 包 @adyen/adyen-web\n\t */\n\tprivate checkAdyenLoaded(): boolean {\n\t\treturn (\n\t\t\tAdyenCheckout !== null &&\n\t\t\ttypeof AdyenCheckout === \"function\" &&\n\t\t\tCard !== null &&\n\t\t\ttypeof Card === \"function\"\n\t\t);\n\t}\n\n\t/**\n\t * 載入 Adyen SDK（從 npm 包）\n\t */\n\tprivate async loadAdyenSDK(): Promise<void> {\n\t\t// 如果已經載入，直接返回\n\t\tif (this.checkAdyenLoaded()) {\n\t\t\treturn;\n\t\t}\n\n\t\t// 動態載入 Adyen SDK\n\t\tconst loaded = await loadAdyenSDK();\n\t\tif (!loaded) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Failed to load Adyen SDK. Please ensure @adyen/adyen-web is installed.\",\n\t\t\t);\n\t\t}\n\n\t\tif (!this.checkAdyenLoaded()) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Adyen SDK loaded but AdyenCheckout or Card is not available.\",\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * 初始化 Adyen\n\t */\n\tprivate async initializeAdyen() {\n\t\t// 防止重複初始化\n\t\tif (this.isInitializing) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\t// 檢查是否在瀏覽器環境\n\t\t\tif (typeof window === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isInitializing = true;\n\n\t\t\t// 載入 Adyen SDK（從 npm 包）\n\t\t\tawait this.loadAdyenSDK();\n\n\t\t\t// 創建 Adyen Checkout 實例\n\t\t\tawait this.createAdyenCheckout();\n\t\t} catch (error) {\n\t\t\tthis.handleError(\"Failed to initialize Adyen\", error);\n\t\t} finally {\n\t\t\tthis.isInitializing = false;\n\t\t}\n\t}\n\n\t/**\n\t * 創建 Adyen Checkout 實例並初始化 Card 組件\n\t */\n\tprivate async createAdyenCheckout() {\n\t\ttry {\n\t\t\tif (!AdyenCheckout || typeof AdyenCheckout !== \"function\") {\n\t\t\t\tthrow new Error(\"AdyenCheckout is not available or not a function\");\n\t\t\t}\n\n\t\t\t// 構建 Adyen Checkout 配置\n\t\t\t// 根據 Adyen 6.0.0 文檔：https://docs.adyen.com/online-payments/upgrade-your-integration/upgrade-to-web-v6\n\t\t\tconst checkoutConfig: Record<string, unknown> = {\n\t\t\t\tenvironment: this.adyenConfig.environment,\n\t\t\t\tclientKey: this.adyenConfig.clientKey,\n\t\t\t\tlocale: this.adyenConfig.locale || \"en-US\",\n\t\t\t\tcountryCode: this.adyenConfig.countryCode, // v6 中為必需\n\t\t\t\tonSubmit: async (\n\t\t\t\t\tstate: unknown,\n\t\t\t\t\tcomponent: unknown,\n\t\t\t\t\tactions?: { resolve: (data?: unknown) => void; reject: () => void },\n\t\t\t\t) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// 調用用戶提供的 onSubmit（如果存在）\n\t\t\t\t\t\tif (this.adyenConfig.onSubmit) {\n\t\t\t\t\t\t\tawait this.adyenConfig.onSubmit(state, component, actions);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// 處理表單提交\n\t\t\t\t\t\tconst formData = this.extractFormData(state);\n\t\t\t\t\t\tif (formData) {\n\t\t\t\t\t\t\tthis.formSubmit.emit(formData);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Adyen v6: 必須調用 actions.resolve() 或 actions.reject()\n\t\t\t\t\t\t// 如果沒有提供 actions，我們仍然處理提交但不控制 Adyen 流程\n\t\t\t\t\t\tif (actions) {\n\t\t\t\t\t\t\t// 這裡應該調用您的支付 API，然後 resolve 或 reject\n\t\t\t\t\t\t\t// 為了簡化，我們先 resolve，實際使用時應該根據 API 響應決定\n\t\t\t\t\t\t\tactions.resolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t// 如果出錯，reject 支付流程\n\t\t\t\t\t\tif (actions) {\n\t\t\t\t\t\t\tactions.reject();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.handleError(\"Payment submission error\", error);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonError: (error: unknown, component: unknown) => {\n\t\t\t\t\t// 調用用戶提供的 onError（如果存在）\n\t\t\t\t\tif (this.adyenConfig.onError) {\n\t\t\t\t\t\tthis.adyenConfig.onError(error, component);\n\t\t\t\t\t}\n\t\t\t\t\t// 處理錯誤\n\t\t\t\t\tthis.handleError(\"Payment error\", error);\n\t\t\t\t},\n\t\t\t\tonChange: (state: unknown, component: unknown) => {\n\t\t\t\t\t// 調用用戶提供的 onChange（如果存在）\n\t\t\t\t\tif (this.adyenConfig.onChange) {\n\t\t\t\t\t\tthis.adyenConfig.onChange(state, component);\n\t\t\t\t\t}\n\t\t\t\t\t// 處理表單變更\n\t\t\t\t\tthis.handleChange(state);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t// 配置 Card 組件的樣式（通過 paymentMethodsConfiguration）\n\t\t\t// 樣式必須在 Checkout 配置中，因為輸入字段在 iframe 中\n\t\t\t// 根據 Adyen v6 文檔，樣式應該在 paymentMethodsConfiguration.card.styles 中\n\t\t\tif (this.adyenConfig.cardStyles) {\n\t\t\t\t// 確保 paymentMethodsConfiguration 對象存在\n\t\t\t\tif (!checkoutConfig.paymentMethodsConfiguration) {\n\t\t\t\t\tcheckoutConfig.paymentMethodsConfiguration = {};\n\t\t\t\t}\n\t\t\t\tconst pmConfig = checkoutConfig.paymentMethodsConfiguration as Record<\n\t\t\t\t\tstring,\n\t\t\t\t\tunknown\n\t\t\t\t>;\n\t\t\t\tpmConfig.card = {\n\t\t\t\t\tstyles: this.adyenConfig.cardStyles,\n\t\t\t\t};\n\t\t\t\tconsole.log(\n\t\t\t\t\t\"[CreditCardForm] Card styles in paymentMethodsConfiguration:\",\n\t\t\t\t\tthis.adyenConfig.cardStyles,\n\t\t\t\t);\n\t\t\t\tconsole.log(\n\t\t\t\t\t\"[CreditCardForm] Full paymentMethodsConfiguration:\",\n\t\t\t\t\tcheckoutConfig.paymentMethodsConfiguration,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// 調試：輸出完整的配置\n\t\t\tconsole.log(\n\t\t\t\t\"[CreditCardForm] Checkout config:\",\n\t\t\t\tJSON.stringify(checkoutConfig, null, 2),\n\t\t\t);\n\n\t\t\t// 創建 Adyen Checkout 實例\n\t\t\tconst checkout = await AdyenCheckout(checkoutConfig);\n\n\t\t\tif (!checkout || typeof checkout !== \"object\") {\n\t\t\t\tthrow new Error(\"Failed to create Adyen Checkout instance\");\n\t\t\t}\n\n\t\t\tconsole.log(\"[CreditCardForm] Checkout instance created:\", checkout);\n\n\t\t\t// 保存 checkout 實例（Adyen v6 使用構造函數方式創建組件）\n\t\t\tthis.adyenCheckout = checkout;\n\n\t\t\t// 創建 Card 組件\n\t\t\tawait this.createCardComponent();\n\t\t} catch (error) {\n\t\t\tthis.handleError(\"Failed to create Adyen checkout\", error);\n\t\t}\n\t}\n\n\t/**\n\t * 創建並掛載 Card 組件\n\t * Adyen v6: 使用構造函數方式創建組件\n\t * const card = new Card(checkout, config).mount('#card');\n\t */\n\tprivate async createCardComponent() {\n\t\tif (!this.adyenCheckout) {\n\t\t\tthrow new Error(\"Adyen Checkout instance is not available\");\n\t\t}\n\n\t\tconst container = this.el.querySelector(`#${this.containerId}`);\n\t\tif (!container) {\n\t\t\tthrow new Error(`Container element #${this.containerId} not found`);\n\t\t}\n\n\t\t// 檢查 Card 構造函數是否可用\n\t\tif (!Card || typeof Card !== \"function\") {\n\t\t\tthrow new Error(\n\t\t\t\t\"Card constructor is not available. Please ensure @adyen/adyen-web is installed.\",\n\t\t\t);\n\t\t}\n\n\t\ttry {\n\t\t\t// 創建 Card 組件配置\n\t\t\t// 根據 Adyen v6 文檔，placeholder 和 styles 都在 Card 配置中\n\t\t\tconst placeholderConfig = this.placeholder || {};\n\t\t\tconst cardConfig: Record<string, unknown> = {\n\t\t\t\tshowPayButton: this.adyenConfig.showPayButton ?? false,\n\t\t\t\tplaceholder: placeholderConfig,\n\t\t\t\t// 樣式配置也放在 Card 配置中（Adyen v6）\n\t\t\t\t...(this.adyenConfig.cardStyles\n\t\t\t\t\t? { styles: this.adyenConfig.cardStyles }\n\t\t\t\t\t: {}),\n\t\t\t\tonChange: (state: unknown) => {\n\t\t\t\t\tconst stateData = state as { isValid: boolean };\n\t\t\t\t\tthis.isValid = stateData.isValid;\n\t\t\t\t\tif (stateData.isValid) {\n\t\t\t\t\t\tthis.errorMessage = \"\";\n\t\t\t\t\t}\n\t\t\t\t\t// 觸發表單變更事件\n\t\t\t\t\tthis.handleChange(state);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (Object.keys(placeholderConfig).length > 0) {\n\t\t\t\tconsole.log(\n\t\t\t\t\t\"[CreditCardForm] Placeholder configured:\",\n\t\t\t\t\tplaceholderConfig,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.adyenConfig.cardStyles) {\n\t\t\t\tconsole.log(\n\t\t\t\t\t\"[CreditCardForm] Card styles in Card config:\",\n\t\t\t\t\tthis.adyenConfig.cardStyles,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// 調試：輸出完整的 Card 配置\n\t\t\tconsole.log(\n\t\t\t\t\"[CreditCardForm] Card config:\",\n\t\t\t\tJSON.stringify(cardConfig, null, 2),\n\t\t\t);\n\n\t\t\t// Adyen v6: 使用構造函數方式創建 Card 組件\n\t\t\t// const card = new Card(checkout, config).mount('#card');\n\t\t\tthis.cardComponent = new Card(this.adyenCheckout, cardConfig);\n\n\t\t\tconsole.log(\n\t\t\t\t\"[CreditCardForm] Card component created:\",\n\t\t\t\tthis.cardComponent,\n\t\t\t);\n\n\t\t\tif (!this.cardComponent) {\n\t\t\t\tthrow new Error(\"Failed to create Card component: component is null\");\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!this.cardComponent.mount ||\n\t\t\t\ttypeof this.cardComponent.mount !== \"function\"\n\t\t\t) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t\"Failed to create Card component: mount method is not available\",\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// 掛載組件到容器\n\t\t\t// 確保容器已存在於 DOM 中\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 0));\n\t\t\tthis.cardComponent.mount(`#${this.containerId}`);\n\n\t\t\t// 標記為準備就緒\n\t\t\tthis.isReady = true;\n\t\t\tthis.formReady.emit();\n\t\t} catch (error) {\n\t\t\tthis.handleError(\"Failed to create Card component\", error);\n\t\t\tthrow error; // 重新拋出以便上層處理\n\t\t}\n\t}\n\n\t/**\n\t * 從 Adyen state 中提取表單數據\n\t */\n\tprivate extractFormData(state: unknown): CreditCardFormData | null {\n\t\tconst stateData = state as {\n\t\t\tisValid: boolean;\n\t\t\tdata?: { paymentMethod?: Record<string, unknown> };\n\t\t};\n\n\t\tif (stateData.isValid && stateData.data?.paymentMethod) {\n\t\t\tconst paymentMethod = stateData.data.paymentMethod as Record<\n\t\t\t\tstring,\n\t\t\t\tstring\n\t\t\t>;\n\n\t\t\treturn {\n\t\t\t\tcardNumber: paymentMethod.encryptedCardNumber || \"\",\n\t\t\t\texpiryDate: paymentMethod.encryptedExpiryDate || \"\",\n\t\t\t\tcvc: paymentMethod.encryptedSecurityCode || \"\",\n\t\t\t\tholderName: paymentMethod.holderName || \"\",\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * 處理表單變更\n\t */\n\tprivate handleChange(state: unknown) {\n\t\tconst stateData = state as {\n\t\t\tisValid: boolean;\n\t\t\tdata?: { paymentMethod?: Record<string, unknown> };\n\t\t};\n\n\t\tif (stateData.isValid && stateData.data?.paymentMethod) {\n\t\t\tconst paymentMethod = stateData.data.paymentMethod as Record<\n\t\t\t\tstring,\n\t\t\t\tstring\n\t\t\t>;\n\n\t\t\tconst formData: CreditCardFormData = {\n\t\t\t\tcardNumber: paymentMethod.encryptedCardNumber || \"\",\n\t\t\t\texpiryDate: paymentMethod.encryptedExpiryDate || \"\",\n\t\t\t\tcvc: paymentMethod.encryptedSecurityCode || \"\",\n\t\t\t\tholderName: paymentMethod.holderName || \"\",\n\t\t\t};\n\n\t\t\tthis.formChange.emit(formData);\n\t\t}\n\t}\n\n\t/**\n\t * 處理錯誤\n\t */\n\tprivate handleError(message: string, error: unknown) {\n\t\tthis.errorMessage = message;\n\t\tthis.formError.emit({ message, error });\n\t\tconsole.error(`[CreditCardForm] ${message}:`, error);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div class=\"credit-card-form\">\n\t\t\t\t<div\n\t\t\t\t\tid={this.containerId}\n\t\t\t\t\tclass={`adyen-container ${this.disabled ? \"disabled\" : \"\"}`}\n\t\t\t\t/>\n\t\t\t\t{this.errorMessage && (\n\t\t\t\t\t<div class=\"error-message\" role=\"alert\">\n\t\t\t\t\t\t{this.errorMessage}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}